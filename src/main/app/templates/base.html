<?xml version="1.0" encoding="utf-8"?>
<!doctype html>
<html lang="en" itemscope itemtype="http://schema.org/Blog" ng-app="blog" ng-controller="RootCtrl">
  <head>
    {# <base href="{{refbase}}" /> #}
    {# <base href="/blog/" /> #}
    {% block title %}{% endblock %}
    <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet">

    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-35014753-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
    <script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.9/jquery.validate.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.0.2/angular.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.0.2/angular-resource.min.js"></script>
    {# <script src="static/js/underscore.js"></script>
    <script type="text/javascript">
      // bootstrap for underscore.js
      _.templateSettings = {
        interpolate: /\{\{(.+?)\}\}/g,
        evaluate: /\{\%(.+?)\%\}/g
      };
    </script> 
    <script type="text/javascript" src="static/js/backbone.js"></script> #}
    <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/blog/static/js/blog.js"></script>

    {# <link href="http://kevinburke.bitbucket.org/markdowncss/markdown.css" rel="stylesheet"></link> #}
  </head>
  <body>
    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          {#
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          #}
          <a class="brand">My Blog</a>
          <div class="nav-collapse">
            <ul class="nav">
              <li class="active"><a href="/blog/">Blog</a></li>
              <!--<li><a href="#contact">Contact</a></li>-->
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>
    <div class="container">
      <header class="hero-unit">
        <h1 id="title" keyname="{{ title }}" itemprop="name">{{ title|title }}</h1>
      </header>
      <div class="row">
        <aside class="span2">
          <iframe src="http://rcm.amazon.com/e/cm?t=david0a-20&o=1&p=11&l=ez&f=ifr&f=ifr" width="120" height="600" scrolling="no" marginwidth="0" marginheight="0" border="0" frameborder="0" style="border:none;"></iframe>
        </aside>
        <div class="span7">
          <nav id="breadcrumbs">
          {% block nav %}{% endblock %}
          </nav>
          {% block article %}{% endblock %}
          <div class="row">
            <div class="span7">
            {% block comments %}{% endblock %}
            </div>
          </div>
          <div class="row" id="addcommentform" style="{{ 'display: none' if not article else '' }}" >
            <div class="span7">
              <h3>Please add your comments</h3>
              <form class="well form-horizontal" name="commentForm" ng-controller="CommentCtrl" ng-submit="submit()">
                <fieldset>
                  <div class="control-group">
                    <label class="control-label" for="screenname">Name*</label>
                    <div class="controls">
                      <input type="text" class="input-xlarge" name="screenname" ng-model="screenname" placeholder="screen name" required ng-minlength="2"/>
                      <span class="error" ng-show="commentForm.screenname.$error.required || commentForm.screenname.$error.minlength">Required!</span>
                    </div>
                  </div>
                  <div class="control-group">
                    <label class="control-label" for="emailaddr">Email*</label>
                    <div class="controls">
                      <input type="email" class="input-xlarge" name="email" ng-model="email" placeholder="email...it will NOT appear publicly" required/>
                      <span class="error" ng-show="commentForm.email.$invalid">Invalid Email!</span>
                    </div>
                  </div>
                  <div class="control-group">
                    <label class="control-label" for="comment">Comments*</label>
                    <div class="controls">
                      <textarea class="input-xlarge" name="comment" ng-model="comment" placeholder="please input your comments here..." required ng-minlength="5"></textarea>
                      <span class="error" ng-show="commentForm.comment.$error.required || commentForm.comment.$error.minlength">Miss Message!</span>
                    </div>
                  </div>
                  <div class="form-actions">
                    <button type="submit" class="btn btn-primary submit" ng-disabled="commentForm.$invalid">Submit</button>
                    <button type="reset" class="btn btn-danger clear">Clear</button>
                  </div>
                </fieldset>
              </form>
            </div>
          </div>
        </div>
        <aside class="span3">
          <div class="well sidebar-nav">
            <ul class="nav nav-list">
              <li class="nav-header">Archives</li>
              {% for y, mo in archives.iteritems() %}
                <li class="nav-header">{{ y }}</li>
                {% for m, t in mo.iteritems() %}
                  <li><a href='/blog/{{ y }}/{{ m }}/'>{{ monthFullName[m-1] }} ({{ t|length }})</a></li>
                {% endfor %}
              {% endfor %}
            </ul>
          </div>
          <div class="well sidebar-nav">
              <ul class="nav nav-list">
                <li class="nav-header">Tags</li>
                {% for t, titles in tags.iteritems() %}
                  <li><a href="/blog/tag/{{ t }}/">{{ t }} ({{ titles|length }})</a></li>
                {% endfor %}
              </ul>
          </div>
        </aside>
      </div>
      <footer>
        <hr />
        <a href="#contact"></a>
        <address>E-Mail: <a href="mailto:">davidshen84 at gmail dot com</a></address>
      </footer>
    </div>
    {# <script src="static/js/less.js"></script> #}

    {% block scripts %}
    {% if not isXhr %}
      <script type="text/javascript">
        // bootstrap script
        window.articlePath = '{{ articlePath }}';
        window.forceLoad = false;
      </script>
    {% endif %}
    {% endblock %}
  </body>
</html>
